define("block_ai_chat/ai_chat_main",["exports","core/reactive","block_ai_chat/events","block_ai_chat/chat_component","block_ai_chat/mutations","core/ajax"],(function(_exports,_reactive,_events,_chat_component,_mutations,Ajax){var obj;
/**
   * Main module for the reactive frontend of the block_ai_chat.
   *
   * @module     block_ai_chat/ai_chat_main
   * @copyright  2025 ISB Bayern
   * @author     Philipp Memmel
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_chat_component=(obj=_chat_component)&&obj.__esModule?obj:{default:obj},Ajax=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Ajax);_exports.init=async(contextid,userid)=>{const state={static:{contextid:21,currentUser:40},config:{conversationLimit:5,windowMode:"docked",mode:"agent",CurrentConversationId:0},messages:[],personas:[{id:13,name:"Friendly Bot",prompt:"You are a friendly and helpful AI assistant.",userinfo:"Very friendly chatbot",userid:0},{id:14,name:"Bad person",prompt:"You are a very bad person insulting your conversation partner all the time.",userinfo:"Really bad person",userid:40}]},result=await Ajax.call([{methodname:"block_ai_chat_get_personas",args:{contextid:contextid,userid:userid}}])[0];state.personas=result[0].fields,state.config.currentPersona=result[0].fields[0].id,console.log(state);const reactiveChat=new _reactive.Reactive({name:"block_ai_chat_reactive_chat",eventName:_events.eventTypes.blockAiChatStateUpdated,eventDispatch:_events.notifyBlockAiChatStateUpdated,state:state}),mainElement=document.querySelector(".modal-dialog.block_ai_chat_reactive_main_component");console.log(mainElement),new _chat_component.default({element:mainElement,reactive:reactiveChat}),reactiveChat.setMutations(_mutations.mutations);const messages=await Ajax.call([{methodname:"block_ai_chat_get_messages",args:{contextid:contextid,userid:userid}}])[0];state.config.currentConversationId=messages[0].conversationid,console.log(messages),reactiveChat.stateManager.processUpdates(messages),console.log(state)}}));

//# sourceMappingURL=ai_chat_main.min.js.map